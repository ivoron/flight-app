(this["webpackJsonpflight-app"]=this["webpackJsonpflight-app"]||[]).push([[0],{21:function(e,t,r){},23:function(e,t,r){"use strict";r.r(t);var i=r(14),n=r(1),s=r.n(n),c=r(7),a=r.n(c),l=r(4),o=r(0);function h(e){var t=e.flightInfo,r=t.price.total;return Object(o.jsxs)("div",{className:"flight-card-price",children:[Object(o.jsxs)("p",{children:["\u2708 ",t.carrier.caption]}),Object(o.jsxs)("p",{children:[r.amount," ",r.currency," ",Object(o.jsx)("br",{}),Object(o.jsx)("span",{children:"\u0421\u0442\u043e\u0438\u043c\u043e\u0441\u0442\u044c \u0434\u043b\u044f \u043e\u0434\u043d\u043e\u0433\u043e \u0432\u0437\u0440\u043e\u0441\u043b\u043e\u0433\u043e \u043f\u0430\u0441\u0441\u0430\u0436\u0438\u0440\u0430"})]})]})}function f(e){var t=e.flightSegment,r=function(e){return"".concat(new Date(e).toLocaleTimeString().slice(0,-3),"\n      ").concat(["\u0432\u0441","\u043f\u043d","\u0432\u0442","\u0441\u0440","\u0447\u0442","\u043f\u0442","\u0441\u0431"][new Date(e).getDay()],",\n        ").concat(new Date(e).getDate(),"\n        ").concat(["\u044f\u043d\u0432\u0430\u044f\u0440\u044f","\u0444\u0435\u0432\u0440\u0430\u043b\u044f","\u043c\u0430\u0440\u0442\u0430","\u0430\u043f\u0440\u0435\u043b\u044f","\u043c\u0430\u044f","\u0438\u044e\u043d\u044f","\u0438\u044e\u043b\u044f","\u0430\u0432\u0433\u0443\u0441\u0442\u0430","\u0441\u0435\u043d\u0442\u044f\u0431\u0440\u044f","\u043e\u043a\u0442\u044f\u0431\u0440\u044f","\u043d\u043e\u044f\u0431\u0440\u044f","\u0434\u0435\u043a\u0430\u0431\u0440\u044f"][new Date(e).getMonth()],"\n      ")},i=t[0].departureDate,n=t[t.length-1].arrivalDate,s=new Date(n).getDay()-new Date(i).getDay();return Object(o.jsxs)("div",{className:"flight-segment",children:[Object(o.jsxs)("div",{className:"flight-card-info",children:[Object(o.jsx)("p",{children:function(e){var t;return"".concat((null===(t=e.departureCity)||void 0===t?void 0:t.caption)||"",",\n    ").concat(e.departureAirport.caption||""," (").concat(e.departureAirport.uid,")")}(t[0])}),Object(o.jsx)("p",{children:"\u2192"}),Object(o.jsx)("p",{children:function(e){var t,r;return"".concat((null===(t=e.arrivalCity)||void 0===t?void 0:t.caption)||"",",\n      ").concat((null===e||void 0===e||null===(r=e.arrivalAirport)||void 0===r?void 0:r.caption)||""," (").concat(e.arrivalAirport.uid,")")}(t[t.length-1])})]}),Object(o.jsxs)("div",{className:"flight-card-info",children:[Object(o.jsxs)("p",{children:["\u041e\u0442\u043f\u0440. ",r(i)]}),Object(o.jsxs)("p",{children:["\ud83d\udd5d ",function(){var e=new Date(n).getHours()-new Date(i).getHours()+24*s,t=new Date(n).getMinutes()-new Date(i).getMinutes();return t<0&&(e-=1,t+=60),"".concat(e,"  \u0447\u0430\u0441. ").concat(t," \u043c\u0438\u043d.")}()]}),Object(o.jsxs)("p",{children:["\u041f\u0440\u0438\u0431. ",r(n)]})]}),Object(o.jsxs)("div",{className:"decorLine",children:[Object(o.jsx)("p",{}),Object(o.jsx)("p",{children:function(){var e="";switch(t.length){case 1:e="\u0431\u0435\u0437 \u043f\u0435\u0440\u0435\u0441\u0430\u0434\u043e\u043a";break;case 2:e="1 \u043f\u0435\u0440\u0435\u0441\u0430\u0434\u043a\u0430 \u0432 \u0430\u044d\u0440\u043e\u043f\u043e\u0440\u0442\u0443 ".concat(t[0].arrivalAirport.caption);break;case 3:e="2 \u043f\u0435\u0440\u0435\u0441\u0430\u0434\u043a\u0438";break;default:e="\u0431\u043e\u043b\u0435\u0435 2\u0445 \u043f\u0435\u0440\u0435\u0441\u0430\u0434\u043e\u043a"}return e}()}),Object(o.jsx)("p",{})]}),Object(o.jsxs)("div",{className:"airline-info",children:["\u0420\u0435\u0439\u0441 \u0432\u044b\u043f\u043e\u043b\u043d\u044f\u0435\u0442: ",t[0].airline.caption]})]})}var u=function(e){var t=e.flightInfo;return Object(o.jsxs)("div",{className:"flight-card",children:[Object(o.jsx)(h,{flightInfo:t}),t.legs.map((function(e){return Object(o.jsx)(f,{flightSegment:e.segments},e.segments[0].arrivalDate)})),Object(o.jsx)("button",{className:"flight-card-btn",children:"\u0432\u044b\u0431\u0440\u0430\u0442\u044c"})]})};function d(){return Object(o.jsxs)("div",{className:"lds-ring",children:[Object(o.jsx)("div",{}),Object(o.jsx)("div",{}),Object(o.jsx)("div",{}),Object(o.jsx)("div",{})]})}function j(){return Object(o.jsx)("div",{className:"no-result-page",children:Object(o.jsx)("h3",{children:"\u041f\u043e \u0432\u0430\u0448\u0435\u043c\u0443 \u0437\u0430\u043f\u0440\u043e\u0441\u0443 \u043d\u0438\u0447\u0435\u0433\u043e \u043d\u0435 \u043d\u0430\u0439\u0434\u0435\u043d\u043e :("})})}var g=Object(l.b)((function(e){var t=e.AppStore,r=t.currentFlights;Object(n.useEffect)((function(){t.getFlightList()}),[t]);var i=s.a.useRef(),c={rootMargin:"100px",threshold:1};return s.a.useEffect((function(){new IntersectionObserver((function(e,r){e[0].isIntersecting&&!t.isLoading&&t.addFlights()}),c).observe(i.current)}),[t]),Object(o.jsxs)("div",{className:"flight-list",children:[t.isLoading?Object(o.jsx)(d,{}):t.showFiltred?t.filtredFlights.map((function(e){return Object(o.jsx)(u,{flightInfo:e.flight},e.flightToken)})):r.map((function(e){return Object(o.jsx)(u,{flightInfo:e.flight},e.flightToken)})),!t.filtredFlights.length&&t.showFiltred?Object(o.jsx)(j,{}):Object(o.jsx)("div",{ref:i})]})})),b=Object(l.b)((function(e){var t=e.carriers,r=e.selectCompanies;return Object(o.jsx)("div",{className:"form-container",children:Object(o.jsxs)("label",{children:[Object(o.jsx)("p",{children:"\u0410\u0432\u0438\u0430\u043a\u043e\u043c\u043f\u0430\u043d\u0438\u0438"}),Object(o.jsx)("form",{className:"sorting-form",children:t.map((function(e){return Object(o.jsxs)("label",{children:[Object(o.jsx)("input",{type:"checkbox",name:e,onChange:function(e){return r(e.target.name,e.target.checked)}}),e]},e)}))})]})})}));function O(e){var t=e.selectTransfers;return Object(o.jsx)("div",{className:"form-container",children:Object(o.jsxs)("label",{children:[Object(o.jsx)("p",{children:"\u0424\u0438\u043b\u044c\u0442\u0440\u043e\u0432\u0430\u0442\u044c"}),Object(o.jsxs)("form",{className:"sorting-form",children:[Object(o.jsxs)("label",{children:[Object(o.jsx)("input",{name:"filter-form",type:"checkbox",value:"no-transfer",onChange:function(e){return t(e.target.value,e.target.checked)}})," ","- \u0431\u0435\u0437 \u043f\u0435\u0440\u0435\u0441\u0430\u0434\u043e\u043a"]}),Object(o.jsxs)("label",{children:[Object(o.jsx)("input",{name:"filter-form",type:"checkbox",value:"one-transfer",onChange:function(e){return t(e.target.value,e.target.checked)}})," ","- \u043e\u0434\u043d\u0430 \u043f\u0435\u0440\u0435\u0441\u0430\u0434\u043a\u0430"]})]})]})})}var p=r(11);function m(e){var t=e.setPriceRange,r=Object(n.useState)(""),i=Object(p.a)(r,2),s=i[0],c=i[1],a=Object(n.useState)(""),l=Object(p.a)(a,2),h=l[0],f=l[1];return Object(n.useEffect)((function(){t(s,h)}),[t,s,h]),Object(o.jsx)("div",{className:"form-container",children:Object(o.jsxs)("label",{children:[Object(o.jsx)("p",{children:"\u0426\u0435\u043d\u0430"}),Object(o.jsxs)("form",{className:"sorting-form",children:[Object(o.jsxs)("label",{children:["\u043e\u0442"," ",Object(o.jsx)("input",{placeholder:"0",type:"number",name:"minPrice",onChange:function(e){return c(e.target.value)},value:s})]}),Object(o.jsxs)("label",{children:["\u0434\u043e"," ",Object(o.jsx)("input",{placeholder:"100000",type:"number",name:"maxPrice",onChange:function(e){return f(e.target.value)},value:h})]})]})]})})}function x(e){var t=e.sortingFlights,r=function(e){t(e)};return Object(o.jsx)("div",{className:"form-container",children:Object(o.jsxs)("label",{children:[Object(o.jsx)("p",{children:"\u0421\u043e\u0440\u0442\u0438\u0440\u043e\u0432\u0430\u0442\u044c"}),Object(o.jsxs)("form",{className:"sorting-form",children:[Object(o.jsxs)("label",{children:[Object(o.jsx)("input",{name:"sorting-form",type:"radio",value:"ascending-price",onInput:function(e){return r(e.target.value)}})," ","- \u0441\u043d\u0430\u0447\u0430\u043b\u0430 \u0434\u0435\u0448\u0435\u0432\u044b\u0435"]}),Object(o.jsxs)("label",{children:[Object(o.jsx)("input",{name:"sorting-form",type:"radio",value:"descending-price",onInput:function(e){return r(e.target.value)}})," ","- \u0441\u043d\u0430\u0447\u0430\u043b\u0430 \u0434\u043e\u0440\u043e\u0433\u0438\u0435"]}),Object(o.jsxs)("label",{children:[Object(o.jsx)("input",{name:"sorting-form",type:"radio",value:"travel-time",onInput:function(e){return r(e.target.value)}})," ","- \u043f\u043e \u0432\u0440\u0435\u043c\u0435\u043d\u0438 \u0432 \u043f\u0443\u0442\u0438"]})]})]})})}var v=Object(l.b)((function(e){var t=e.AppStore;return Object(o.jsxs)("div",{className:"sidebar-container",children:[Object(o.jsxs)("div",{className:"sidebar",children:[Object(o.jsx)(x,{sortingFlights:t.sortingFlights}),Object(o.jsx)(O,{selectTransfers:t.selectTransfers}),Object(o.jsx)(m,{showPriceRange:t.showPriceRange,setPriceRange:t.setPriceRange}),Object(o.jsx)(b,{carriers:t.carriers,selectCompanies:t.selectCompanies})]}),t.showFiltred&&(t.filtredFlights.length?Object(o.jsxs)("p",{className:"filter-message",children:["\u041d\u0430\u0439\u0434\u0435\u043d\u043e: ",t.filtredFlights.length," \u0440\u0435\u0439\u0441\u043e\u0432"]}):Object(o.jsx)("p",{className:"filter-message",children:"\u041f\u043e \u0437\u0430\u0434\u0430\u043d\u043d\u043e\u043c\u0443 \u0444\u0438\u043b\u044c\u0442\u0440\u0443 \u0440\u0435\u0439\u0441\u043e\u0432 \u043d\u0435 \u043d\u0430\u0439\u0434\u0435\u043d\u043e"}))]})})),F=Object(l.a)("store")(Object(l.b)((function(e){var t=e.store;return Object(o.jsxs)("div",{className:"App",children:[Object(o.jsx)(v,{AppStore:t}),Object(o.jsx)("div",{className:"content",children:Object(o.jsx)(g,{AppStore:t})})]})}))),w=(r(21),r(9)),P=r(10),N=r.n(P),y=r(3),C=r(12),S=r(13),D=r(2),I={store:new function e(){var t=this;Object(S.a)(this,e),this.allFlights=[],this.currentFlights=[],this.filtredFlights=[],this.bestPrices={},this.filterPrices={minPrice:"",maxPrice:""},this.transferOptions=[],this.carriers=[],this.filtredCarriers=[],this.isLoading=!0,this.showFiltred=!1,this.startIndex=0,this.listLimit=10,this.endIndex=10,this.getFlightList=Object(C.a)(N.a.mark((function e(){return N.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:fetch("./flights.json").then((function(e){return e.json()})).then((function(e){return e.result})).then((function(e){var r;(r=t.allFlights).push.apply(r,Object(y.a)(e.flights)),t.bestPrices=JSON.parse(JSON.stringify(e.bestPrices))})).then((function(){t.loadFlights()})).catch((function(e){return console.error(e)}));case 1:case"end":return e.stop()}}),e)}))),this.loadFlights=function(){for(var e=t.startIndex;e<t.endIndex;e++)t.currentFlights.push(t.allFlights[e]);t.setLoading(!1)},this.addFlights=function(){t.setLoading(!0),t.startIndex+=t.listLimit,t.endIndex+=t.listLimit,t.loadFlights(),t.setLoading(!1)},this.setLoading=function(e){t.isLoading=e},this.sortingFlights=function(e){switch(t.showFiltred||(t.filtredFlights=Object(y.a)(t.currentFlights),t.setShowFiltred(!0)),e){case"ascending-price":t.filtredFlights.sort((function(e,t){return+e.flight.price.total.amount>+t.flight.price.total.amount?1:+e.flight.price.total.amount<+t.flight.price.total.amount?-1:0}));break;case"descending-price":t.filtredFlights.sort((function(e,t){return+e.flight.price.total.amount<+t.flight.price.total.amount?1:+e.flight.price.total.amount>+t.flight.price.total.amount?-1:0}));break;case"travel-time":t.filtredFlights.sort((function(e,t){return e.flight.legs[0].duration+e.flight.legs[1].duration>t.flight.legs[0].duration+t.flight.legs[1].duration?1:e.flight.legs[0].duration+e.flight.legs[1].duration<t.flight.legs[0].duration+t.flight.legs[1].duration?-1:0}))}t.setCarriers()},this.setShowFiltred=function(e){t.showFiltred=e},this.filterByValue=function(e){var r=Object(y.a)(t.filtredFlights);if(t.showPriceRange(),"transfer"===e){if(t.transferOptions.length){t.setShowFiltred(!0);var i,n=Object(w.a)(t.transferOptions);try{for(n.s();!(i=n.n()).done;){var s=i.value;"no-transfer"===s?t.filtredFlights=Object(y.a)(t.filtredFlights.filter((function(e){return 1===e.flight.legs[0].segments.length&&1===e.flight.legs[1].segments.length}))):"one-transfer"===s&&(t.filtredFlights=Object(y.a)(t.filtredFlights.filter((function(e){return e.flight.legs[0].segments.length+e.flight.legs[1].segments.length===3}))))}}catch(h){n.e(h)}finally{n.f()}}else t.setShowFiltred(!1),t.filtredFlights=Object(y.a)(r);t.setCarriers()}if("career"===e){var c=Object(y.a)(t.filtredFlights);if(t.filtredCarriers.length){t.filtredFlights=[];var a,l=Object(w.a)(t.filtredCarriers);try{var o=function(){var e=a.value;t.filtredFlights=[].concat(Object(y.a)(t.filtredFlights),Object(y.a)(t.currentFlights.filter((function(t){return t.flight.carrier.caption===e}))))};for(l.s();!(a=l.n()).done;)o()}catch(h){l.e(h)}finally{l.f()}t.setShowFiltred(!0)}else t.filtredFlights=Object(y.a)(c)}},this.setPriceRange=function(e,r){t.filterPrices={minPrice:e,maxPrice:r},t.showPriceRange()},this.showPriceRange=function(){t.setShowFiltred(!0),t.filterPrices.maxPrice?t.filtredFlights=t.currentFlights.filter((function(e){return e.flight.price.total.amount>+t.filterPrices.minPrice&&e.flight.price.total.amount<+t.filterPrices.maxPrice})):t.filtredFlights=t.currentFlights.filter((function(e){return e.flight.price.total.amount>+t.filterPrices.minPrice})),t.filterPrices.minPrice||t.filterPrices.maxPrice||t.setShowFiltred(!1),t.setCarriers()},this.selectTransfers=function(e,r){t.transferOptions=r?[].concat(Object(y.a)(t.transferOptions),[e]):t.transferOptions.filter((function(t){return t!==e})),t.filterByValue("transfer")},this.selectCompanies=function(e,r){t.filtredCarriers=r?[].concat(Object(y.a)(t.filtredCarriers),[e]):t.filtredCarriers.filter((function(t){return t!==e})),t.filterByValue("career")},this.setCarriers=function(){t.carriers.length=0,t.filtredFlights.map((function(e){return t.carriers.push(e.flight.carrier.caption)})),t.carriers=Array.from(new Set(t.carriers))},Object(D.l)(this)}};a.a.render(Object(o.jsx)(s.a.StrictMode,{children:Object(o.jsx)(F,Object(i.a)({},I))}),document.getElementById("root"))}},[[23,1,2]]]);
//# sourceMappingURL=main.c9304c0a.chunk.js.map